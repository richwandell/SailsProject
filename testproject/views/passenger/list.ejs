<div class="page-header">
    <h1>Sails.js Example App <small>by Rich Wandell</small></h1>
</div>
<ul class="nav nav-tabs">
    <li role="presentation"><a href="/car/list">Cars</a></li>
    <li role="presentation" class="active"><a href="/passenger/list">Passengers</a></li>
    <li role="presentation"><a href="/family/list">Families</a></li>
    <li role="presentation"><a href="/part/list">Car Parts</a></li>
</ul>
<div class="panel panel-default" id="passenger_list">
    <table class="table table-striped table-hover">
        <caption>
            All Passengers in All Cars <br>
            <%- req.flash('message') %>
            <%- req.flash('error') %>
        </caption>
        <thead>
        <tr>
            <th>Name</th>
            <th>Car</th>
            <th>Family</th>
        </tr>
        </thead>
        <tbody>
        <% passengers.forEach(function(passenger){ %>
            <tr>
                <td><%- passenger.first_name + " " + passenger.last_name %></td>
                <td>
                    <% if(passenger.car){ %>
                    <a href="/car/passenger/<%- passenger.car.id %>">
                        <%- passenger.car.name %>
                    </a>
                    <% } %>
                </td>
                <td><%- passenger.family %></td>
                <td>
                    <form action="/passenger/deletePassenger" method="POST">
                        <input type="hidden" name="_csrf" value="<%= _csrf %>" />
                        <input type="hidden" name="passenger_id" value="<%- passenger.id %>"/>
                        <input class="btn btn-danger" type="submit" value="Delete" />
                    </form>
                </td>
            </tr>
        <% }); %>
        </tbody>
    </table>
</div>
<div class="panel panel-default" id="new_passenger">
    <form class="form-horizontal" action="/passenger/addPassenger" method="POST">
        <input type="hidden" name="_csrf" value="<%= _csrf %>" />
        <div class="form-group <%- req.flash("first_name_error") %>">
            <label for="passenger_first_name" class="col-sm-2 control-label">First Name</label>
            <div class="col-sm-10">
                <input value="<%- req.flash('first_name_entry') %>" type="text" class="form-control" id="passenger_first_name" placeholder="First Name" name="passenger_first_name">
            </div>
        </div>
        <div class="form-group <%- req.flash("last_name_error") %>">
            <label for="passenger_last_name" class="col-sm-2 control-label">Last Name</label>
            <div class="col-sm-10">
                <input value="<%- req.flash('last_name_entry') %>" type="text" class="form-control" id="passenger_last_name" placeholder="Last Name" name="passenger_last_name">
            </div>
        </div>
        <div class="form-group">
            <label for="passenger_car" class="col-sm-2 control-label">Car</label>
            <div class="col-sm-10">
                <select class="form-control" name="passenger_car">
                    <% cars.forEach(function(car){ %>
                        <option value="<%- car.id %>"><%- car.name %></option>
                    <% })%>
                </select>
            </div>
        </div>
        <input type="submit" class="btn btn-default" value="Add Passenger"/>
    </form>
</div>